{"ast":null,"code":"import _toConsumableArray from\"/Users/yong/development/projects/rtv-mern-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/Users/yong/development/projects/rtv-mern-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState,useContext}from\"react\";import CommentList from\"./CommentList.js\";import{userAxios,UserContext}from\"../context/UserProvider\";import{BiComment}from\"react-icons/bi\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var style={form:\"flex\"};var CommentForm=function CommentForm(props){var initComment=\"\";var _useState=useState(initComment),_useState2=_slicedToArray(_useState,2),comment=_useState2[0],setComment=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),comments=_useState4[0],setComments=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isOpen=_useState6[0],setIsOpen=_useState6[1];var _id=props._id;var _useContext=useContext(UserContext),allComments=_useContext.allComments,getComments=_useContext.getComments;var addComment=function addComment(){userAxios.post(\"/api/comment/\".concat(_id),{comment:comment}).then(function(res){setComments(function(prevComments){return[].concat(_toConsumableArray(prevComments),[res.data]);});console.log(\"this is line 23 of comments: \",comments);console.log(\"this is line 24 of comments: \",res.data);}).catch(function(err){return console.log(err.response.data.errMsg);});};var handleCommentSubmit=function handleCommentSubmit(e){e.preventDefault();addComment();setComment(initComment);};var handleShowComments=function handleShowComments(){userAxios.get(\"/api/comment/\".concat(_id)).then(function(res){console.log(res.data);setComments(res.data);}).catch(function(err){return console.log(err);});// }\nsetIsOpen(!isOpen);};useEffect(function(){handleShowComments();setIsOpen(isOpen);},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2.5 hover:bg-slate-300\",children:[/*#__PURE__*/_jsx(BiComment,{onClick:handleShowComments,className:\"my-3 text-[25px]\"}),/*#__PURE__*/_jsxs(\"p\",{children:[comments.length,\" comments\"]})]}),isOpen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCommentSubmit,className:style.form,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"comment\",value:comment,onChange:function onChange(e){return setComment(e.target.value);},className:\"w-[80%] p-[10px] border border-[#343434] m-2\",placeholder:\"add comment\"}),/*#__PURE__*/_jsx(\"button\",{className:\"w-[80%] bg-[#efefef] m-2 h-[45px]\",children:\"Add Comment\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CommentList,{comments:comments}),/*#__PURE__*/_jsx(\"button\",{className:\"my-[10px] p-[5px] w-[80%]\",onClick:function onClick(){return setIsOpen(false);},children:\"Close Comments\"})]})]})]});};export default CommentForm;","map":{"version":3,"names":["React","useEffect","useState","useContext","CommentList","userAxios","UserContext","BiComment","style","form","CommentForm","props","initComment","comment","setComment","comments","setComments","isOpen","setIsOpen","_id","allComments","getComments","addComment","post","then","res","prevComments","data","console","log","catch","err","response","errMsg","handleCommentSubmit","e","preventDefault","handleShowComments","get","length","target","value"],"sources":["/Users/yong/development/projects/rtv-mern-app/client/src/components/CommentForm.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from \"react\"\nimport CommentList from \"./CommentList.js\"\nimport { userAxios, UserContext } from \"../context/UserProvider\"\nimport { BiComment } from \"react-icons/bi\"\n\nconst style = {\n  form: `flex`,\n}\nconst CommentForm = (props) => {\n  const initComment = \"\"\n  const [comment, setComment] = useState(initComment)\n  const [comments, setComments] = useState([])\n  const [isOpen, setIsOpen] = useState(false)\n  const { _id } = props\n  const { allComments, getComments } = useContext(UserContext)\n\n  const addComment = () => {\n    userAxios\n      .post(`/api/comment/${_id}`, { comment })\n      .then((res) => {\n        setComments((prevComments) => {\n          return [...prevComments, res.data]\n        })\n        console.log(\"this is line 23 of comments: \", comments)\n        console.log(\"this is line 24 of comments: \", res.data)\n      })\n      .catch((err) => console.log(err.response.data.errMsg))\n  }\n\n  const handleCommentSubmit = (e) => {\n    e.preventDefault()\n    addComment()\n    setComment(initComment)\n  }\n\n  const handleShowComments = () => {\n    userAxios\n      .get(`/api/comment/${_id}`)\n      .then((res) => {\n        console.log(res.data)\n        setComments(res.data)\n      })\n      .catch((err) => console.log(err))\n    // }\n    setIsOpen(!isOpen)\n  }\n\n  useEffect(() => {\n    handleShowComments()\n    setIsOpen(isOpen)\n  }, [])\n\n  return (\n    <>\n      <div className='flex items-center gap-2.5 hover:bg-slate-300'>\n        <BiComment onClick={handleShowComments} className='my-3 text-[25px]' />\n        <p>{comments.length} comments</p>\n      </div>\n      {isOpen && (\n        <>\n          <form onSubmit={handleCommentSubmit} className={style.form}>\n            <input\n              type='text'\n              name='comment'\n              value={comment}\n              onChange={(e) => setComment(e.target.value)}\n              className='w-[80%] p-[10px] border border-[#343434] m-2'\n              placeholder='add comment'\n            />\n            <button className='w-[80%] bg-[#efefef] m-2 h-[45px]'>\n              Add Comment\n            </button>\n          </form>\n\n          <div>\n            <CommentList comments={comments} />\n            <button\n              className='my-[10px] p-[5px] w-[80%]'\n              onClick={() => setIsOpen(false)}\n            >\n              Close Comments\n            </button>\n          </div>\n        </>\n      )}\n    </>\n  )\n}\n\nexport default CommentForm\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}