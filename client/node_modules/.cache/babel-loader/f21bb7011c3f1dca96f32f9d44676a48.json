{"ast":null,"code":"import _slicedToArray from\"/Users/yong/development/projects/rtv-mern-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useState,useEffect}from\"react\";import CommentForm from\"./CommentForm.js\";import{UserContext}from\"../context/UserProvider.js\";import{userAxios}from\"../context/UserProvider\";import IssueForm from\"./IssueForm.js\";import{FiThumbsUp,FiThumbsDown}from\"react-icons/fi\";import{BsThreeDots}from\"react-icons/bs\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var style={cardContainer:\"border border-black rounded-lg m-5\",card:\"flex flex-col m-4\",header:\"flex justify-between\",img:\"max-h-[screen] max-w-[500px] my-3\",h1:\"text-2xl\",p:\"my-[10px]\",cardActions:\"flex justify-between items-center\",rating:\"flex gap-2\",delete:\"my-[10px] p-[10px] w-9/12\",edit:\"my-[10px] p-[10px] w-9/12\"};var IssueCard=function IssueCard(props){var title=props.title,description=props.description,_id=props._id,user=props.user,comment=props.comment,imgUrl=props.imgUrl,upvotes=props.upvotes,downvotes=props.downvotes;var _useState=useState(upvotes.length),_useState2=_slicedToArray(_useState,2),upvotesCount=_useState2[0],setUpvotesCount=_useState2[1];var _useState3=useState(downvotes.length),_useState4=_slicedToArray(_useState3,2),downvotesCount=_useState4[0],setDownvotesCount=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),editToggle=_useState6[0],setEditToggle=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isVoted=_useState8[0],setIsVoted=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),menu=_useState10[0],setMenu=_useState10[1];var _useContext=useContext(UserContext),deleteIssue=_useContext.deleteIssue,getUserIssues=_useContext.getUserIssues,editIssue=_useContext.editIssue,username=_useContext.user.username,usersList=_useContext.usersList,getUsersList=_useContext.getUsersList,allIssues=_useContext.allIssues;useEffect(function(){getUserIssues();},[downvotesCount,upvotesCount]);useEffect(function(){getUsersList();},[]);var handleUpvote=function handleUpvote(){userAxios.put(\"/api/issue/upvote/\".concat(_id)).then(function(res){console.log(\"this is res.data.upvotes \".concat(res.data.upvotes));setUpvotesCount(res.data.upvotes.length);setDownvotesCount(res.data.downvotes.length);}).catch(function(err){return console.log(err);});};var handleDownvote=function handleDownvote(){userAxios.put(\"/api/issue/downvote/\".concat(_id)).then(function(res){console.log(res.data.downvotes);setDownvotesCount(res.data.downvotes.length);setUpvotesCount(res.data.upvotes.length);}).catch(function(err){return console.log(err);});};var handleMenuClick=function handleMenuClick(){return setMenu(!menu);};var originalPoster=usersList.map(function(user){return user._id===props.user&&user.username;});var userIdentity=allIssues.map(function(issue){return issue.user;});console.log(props.user);console.log(userIdentity);return/*#__PURE__*/_jsx(\"div\",{className:style.cardContainer,children:!editToggle?/*#__PURE__*/_jsxs(\"div\",{className:style.card,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.header,children:[/*#__PURE__*/_jsx(\"h1\",{className:style.h1,children:title}),/*#__PURE__*/_jsx(BsThreeDots,{onClick:handleMenuClick,className:\"text-[25px] hover:bg-slate-100\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:!menu?\"hidden\":\"w-full h-full bg-slate-300 flex flex-col items-center justify-center rounded\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"py-3 text-xl\",onClick:function onClick(){return originalPoster===userIdentity?deleteIssue(_id):alert(\"You do not have autority to delete this issue\");},children:\"delete\"}),/*#__PURE__*/_jsx(\"button\",{className:\"py-3 text-xl\",onClick:function onClick(){return setEditToggle(function(prevToggle){return!prevToggle;});},children:\"edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"py-3 text-xl\",onClick:handleMenuClick,children:\"cancel\"})]}),/*#__PURE__*/_jsx(\"p\",{className:style.p,children:description}),/*#__PURE__*/_jsx(\"img\",{src:imgUrl,className:style.img}),/*#__PURE__*/_jsxs(\"div\",{className:style.cardActions,children:[/*#__PURE__*/_jsxs(\"div\",{className:style.rating,children:[/*#__PURE__*/_jsx(FiThumbsUp,{onClick:handleUpvote,className:upvotesCount>0&&upvotesCount>downvotesCount||upvotesCount>downvotesCount?\"text-blue-600 text-[25px] hover:bg-slate-400\":\"text-[25px] hover:bg-slate-300\"}),upvotesCount,/*#__PURE__*/_jsx(FiThumbsDown,{onClick:handleDownvote,className:downvotesCount>0&&downvotesCount>upvotesCount||downvotesCount>upvotesCount?\"text-blue-600 text-[25px] hover:bg-slate-300\":\"text-[25px] hover:bg-slate-300\"}),downvotesCount]}),/*#__PURE__*/_jsx(\"div\",{className:style.comment,children:/*#__PURE__*/_jsx(CommentForm,{_id:_id})})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Posted by: \",originalPoster]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(IssueForm,{title:title,description:description,imgUrl:imgUrl,btnText:\"Submit Edit\",_id:_id,submit:editIssue,handleClose:setEditToggle}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setEditToggle(function(prevToggle){return!prevToggle;});},children:\"Close\"})]})});};export default IssueCard;","map":{"version":3,"names":["React","useContext","useState","useEffect","CommentForm","UserContext","userAxios","IssueForm","FiThumbsUp","FiThumbsDown","BsThreeDots","style","cardContainer","card","header","img","h1","p","cardActions","rating","delete","edit","IssueCard","props","title","description","_id","user","comment","imgUrl","upvotes","downvotes","length","upvotesCount","setUpvotesCount","downvotesCount","setDownvotesCount","editToggle","setEditToggle","isVoted","setIsVoted","menu","setMenu","deleteIssue","getUserIssues","editIssue","username","usersList","getUsersList","allIssues","handleUpvote","put","then","res","console","log","data","catch","err","handleDownvote","handleMenuClick","originalPoster","map","userIdentity","issue","alert","prevToggle"],"sources":["/Users/yong/development/projects/rtv-mern-app/client/src/components/IssueCard.js"],"sourcesContent":["import React, { useContext, useState, useEffect } from \"react\"\nimport CommentForm from \"./CommentForm.js\"\nimport { UserContext } from \"../context/UserProvider.js\"\nimport { userAxios } from \"../context/UserProvider\"\nimport IssueForm from \"./IssueForm.js\"\nimport { FiThumbsUp, FiThumbsDown } from \"react-icons/fi\"\nimport { BsThreeDots } from \"react-icons/bs\"\n\nconst style = {\n  cardContainer: `border border-black rounded-lg m-5`,\n  card: `flex flex-col m-4`,\n  header: `flex justify-between`,\n  img: `max-h-[screen] max-w-[500px] my-3`,\n  h1: `text-2xl`,\n  p: `my-[10px]`,\n  cardActions: `flex justify-between items-center`,\n  rating: `flex gap-2`,\n  delete: `my-[10px] p-[10px] w-9/12`,\n  edit: `my-[10px] p-[10px] w-9/12`,\n}\n\nconst IssueCard = (props) => {\n  const { title, description, _id, user, comment, imgUrl, upvotes, downvotes } =\n    props\n  const [upvotesCount, setUpvotesCount] = useState(upvotes.length)\n  const [downvotesCount, setDownvotesCount] = useState(downvotes.length)\n  const [editToggle, setEditToggle] = useState(false)\n  const [isVoted, setIsVoted] = useState(false)\n  const [menu, setMenu] = useState(false)\n  const {\n    deleteIssue,\n    getUserIssues,\n    editIssue,\n    user: { username },\n    usersList,\n    getUsersList,\n    allIssues,\n  } = useContext(UserContext)\n\n  useEffect(() => {\n    getUserIssues()\n  }, [downvotesCount, upvotesCount])\n\n  useEffect(() => {\n    getUsersList()\n  }, [])\n\n  const handleUpvote = () => {\n    userAxios\n      .put(`/api/issue/upvote/${_id}`)\n      .then((res) => {\n        console.log(`this is res.data.upvotes ${res.data.upvotes}`)\n        setUpvotesCount(res.data.upvotes.length)\n        setDownvotesCount(res.data.downvotes.length)\n      })\n      .catch((err) => console.log(err))\n  }\n  const handleDownvote = () => {\n    userAxios\n      .put(`/api/issue/downvote/${_id}`)\n      .then((res) => {\n        console.log(res.data.downvotes)\n        setDownvotesCount(res.data.downvotes.length)\n        setUpvotesCount(res.data.upvotes.length)\n      })\n      .catch((err) => console.log(err))\n  }\n\n  const handleMenuClick = () => setMenu(!menu)\n\n  const originalPoster = usersList.map(\n    (user) => user._id === props.user && user.username\n  )\n  const userIdentity = allIssues.map((issue) => issue.user)\n  console.log(props.user)\n  console.log(userIdentity)\n\n  return (\n    <div className={style.cardContainer}>\n      {!editToggle ? (\n        <div className={style.card}>\n          <div className={style.header}>\n            <h1 className={style.h1}>{title}</h1>\n            {/* //three dot menubar */}\n            <BsThreeDots\n              onClick={handleMenuClick}\n              className='text-[25px] hover:bg-slate-100'\n            />\n          </div>\n          {/* Card menu */}\n          <div\n            className={\n              !menu\n                ? \"hidden\"\n                : \"w-full h-full bg-slate-300 flex flex-col items-center justify-center rounded\"\n            }\n          >\n            <button\n              className='py-3 text-xl'\n              onClick={() =>\n                originalPoster === userIdentity\n                  ? deleteIssue(_id)\n                  : alert(\"You do not have autority to delete this issue\")\n              }\n            >\n              delete\n            </button>\n            <button\n              className='py-3 text-xl'\n              onClick={() => setEditToggle((prevToggle) => !prevToggle)}\n            >\n              edit\n            </button>\n            <button className='py-3 text-xl' onClick={handleMenuClick}>\n              cancel\n            </button>\n          </div>\n          <p className={style.p}>{description}</p>\n          <img src={imgUrl} className={style.img}></img>\n          <div className={style.cardActions}>\n            <div className={style.rating}>\n              <FiThumbsUp\n                onClick={handleUpvote}\n                className={\n                  (upvotesCount > 0 && upvotesCount > downvotesCount) ||\n                  upvotesCount > downvotesCount\n                    ? \"text-blue-600 text-[25px] hover:bg-slate-400\"\n                    : \"text-[25px] hover:bg-slate-300\"\n                }\n              />\n              {upvotesCount}\n              <FiThumbsDown\n                onClick={handleDownvote}\n                className={\n                  (downvotesCount > 0 && downvotesCount > upvotesCount) ||\n                  downvotesCount > upvotesCount\n                    ? \"text-blue-600 text-[25px] hover:bg-slate-300\"\n                    : \"text-[25px] hover:bg-slate-300\"\n                }\n              />\n              {downvotesCount}\n            </div>\n            {/* <p>Total Votes: {upvotesCount + downvotesCount}</p> */}\n            <div className={style.comment}>\n              <CommentForm _id={_id} />\n            </div>\n          </div>\n          <p>Posted by: {originalPoster}</p>\n        </div>\n      ) : (\n        <>\n          <IssueForm\n            title={title}\n            description={description}\n            imgUrl={imgUrl}\n            btnText='Submit Edit'\n            _id={_id}\n            submit={editIssue}\n            handleClose={setEditToggle}\n          />\n          <button onClick={() => setEditToggle((prevToggle) => !prevToggle)}>\n            Close\n          </button>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport default IssueCard\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}